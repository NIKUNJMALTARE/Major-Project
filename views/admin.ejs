<!DOCTYPE html>
<html lang="en">
  <%- include('./header.ejs'); %>
  <!-- Add Bootstrap 5 JS for modal functionality -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
    crossorigin="anonymous"
  ></script>
  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- Admin Sidebar -->
        <div class="col-md-2 bg-dark text-white p-4 min-vh-100">
          <h4 class="mb-4">Admin Dashboard</h4>
          <div
            class="nav flex-column nav-pills"
            id="v-pills-tab"
            role="tablist"
            aria-orientation="vertical"
          >
            <a
              class="nav-link active text-white"
              id="v-pills-users-tab"
              data-bs-toggle="pill"
              data-bs-target="#users"
              role="tab"
              aria-controls="users"
              aria-selected="true"
            >
              <i class="fas fa-users me-2"></i> User Management
            </a>
            <a
              class="nav-link text-white"
              id="v-pills-posts-tab"
              data-bs-toggle="pill"
              data-bs-target="#posts"
              role="tab"
              aria-controls="posts"
              aria-selected="false"
            >
              <i class="fas fa-newspaper me-2"></i> Feed Management
            </a>
            <a class="nav-link text-white" href="/dashboard">
              <i class="fas fa-user me-2"></i> My Profile
            </a>
            <a class="nav-link text-white" href="/logout">
              <i class="fas fa-sign-out-alt me-2"></i> Logout
            </a>
          </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-10 p-4">
          <div class="tab-content" id="v-pills-tabContent">
            <!-- User Management Tab -->
            <div
              class="tab-pane fade show active"
              id="users"
              role="tabpanel"
              aria-labelledby="v-pills-users-tab"
            >
              <div
                class="d-flex justify-content-between align-items-center mb-4"
              >
                <h3>User Management</h3>
                <button
                  class="btn btn-primary"
                  data-bs-toggle="modal"
                  data-bs-target="#addUserModal"
                >
                  <i class="fas fa-plus me-2"></i> Add New User
                </button>
              </div>

              <!-- Search and Filter -->
              <div class="card mb-4">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-8">
                      <input
                        type="text"
                        id="userSearchInput"
                        class="form-control"
                        placeholder="Search users by name, email, batch..."
                      />
                    </div>
                    <div class="col-md-4">
                      <select class="form-control" id="userFilterSelect">
                        <option value="">All Users</option>
                        <option value="Admin">Admins</option>
                        <option value="Alumni">Alumni</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <!-- User Table -->
              <div class="card">
                <div class="card-body p-0">
                  <div class="table-responsive">
                    <table class="table" id="usersTable">
                      <thead class="bg-light">
                        <tr>
                          <th>Name</th>
                          <th>Email</th>
                          <th>Batch</th>
                          <th>Type</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody id="userTableBody">
                        <!-- Users will be loaded dynamically -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>

            <!-- Feed Management Tab -->
            <div
              class="tab-pane fade"
              id="posts"
              role="tabpanel"
              aria-labelledby="v-pills-posts-tab"
            >
              <div
                class="d-flex justify-content-between align-items-center mb-4"
              >
                <h3>Feed Management</h3>
                <button
                  class="btn btn-primary"
                  data-bs-toggle="modal"
                  data-bs-target="#addPostModal"
                >
                  <i class="fas fa-plus me-2"></i> Create New Post
                </button>
              </div>

              <!-- Search and Filter -->
              <div class="card mb-4">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-8">
                      <input
                        type="text"
                        id="postSearchInput"
                        class="form-control"
                        placeholder="Search posts by title, content..."
                      />
                    </div>
                    <div class="col-md-4">
                      <select class="form-control" id="postFilterSelect">
                        <option value="">All Posts</option>
                        <option value="News">News</option>
                        <option value="Event">Events</option>
                        <option value="Job">Jobs</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Post Grid -->
              <div class="row" id="postsGrid">
                <!-- Posts will be loaded dynamically -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add User Modal -->
    <div
      class="modal fade"
      id="addUserModal"
      tabindex="-1"
      role="dialog"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New User</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="addUserForm" action="/api/admin/addUser" method="POST">
              <div class="row">
                <div class="col-md-6 form-group">
                  <label>Name</label>
                  <input
                    type="text"
                    name="name"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-6 form-group">
                  <label>Email</label>
                  <input
                    type="email"
                    name="email"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 form-group">
                  <label>Username</label>
                  <input
                    type="text"
                    name="username"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Password</label>
                  <input
                    type="password"
                    name="password"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Confirm Password</label>
                  <input
                    type="password"
                    name="password2"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 form-group">
                  <label>Batch</label>
                  <input
                    type="number"
                    name="batch"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Branch</label>
                  <input
                    type="text"
                    name="branch"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Degree</label>
                  <input
                    type="text"
                    name="degree"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 form-group">
                  <label>User Type</label>
                  <select name="userType" class="form-control">
                    <option value="alumni">Alumni</option>
                    <option value="admin">Admin</option>
                  </select>
                </div>
                <div
                  class="col-md-6 form-group admin-only"
                  style="display: none"
                >
                  <label>Admin Level</label>
                  <select name="adminLevel" class="form-control">
                    <option value="content">Content Admin</option>
                    <option value="user">User Admin</option>
                    <option value="super">Super Admin</option>
                  </select>
                </div>
              </div>
              <button type="submit" class="btn btn-primary">Add User</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Post Modal -->
    <div
      class="modal fade"
      id="addPostModal"
      tabindex="-1"
      role="dialog"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create New Post</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="addPostForm" action="/api/admin/createPost" method="POST">
              <div class="form-group">
                <label>Title</label>
                <input type="text" name="title" class="form-control" required />
              </div>
              <div class="form-group">
                <label>Short Description</label>
                <input
                  type="text"
                  name="short_description"
                  class="form-control"
                  required
                />
              </div>
              <div class="row">
                <div class="col-md-6 form-group">
                  <label>Category</label>
                  <select name="category" class="form-control">
                    <option value="News">News</option>
                    <option value="Event">Event</option>
                    <option value="Job">Job</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="col-md-6 form-group">
                  <label>Visibility</label>
                  <select name="visibilty" class="form-control">
                    <option value="Public">Public</option>
                    <option value="Private">Private</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label>Content</label>
                <textarea
                  name="post"
                  class="form-control"
                  rows="10"
                  required
                ></textarea>
              </div>
              <button type="submit" class="btn btn-primary">Create Post</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit User Modal -->
    <div
      class="modal fade"
      id="editUserModal"
      tabindex="-1"
      role="dialog"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit User</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form
              id="editUserForm"
              action="/api/admin/updateUser"
              method="POST"
            >
              <input type="hidden" name="userId" id="editUserId" />
              <div class="row">
                <div class="col-md-6 form-group">
                  <label>Name</label>
                  <input
                    type="text"
                    name="name"
                    id="editUserName"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-6 form-group">
                  <label>Email</label>
                  <input
                    type="email"
                    name="email"
                    id="editUserEmail"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 form-group">
                  <label>Batch</label>
                  <input
                    type="number"
                    name="batch"
                    id="editUserBatch"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Branch</label>
                  <input
                    type="text"
                    name="branch"
                    id="editUserBranch"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-4 form-group">
                  <label>Degree</label>
                  <input
                    type="text"
                    name="degree"
                    id="editUserDegree"
                    class="form-control"
                    required
                  />
                </div>
              </div>
              <button type="submit" class="btn btn-primary">Update User</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Post Modal -->
    <div
      class="modal fade"
      id="editPostModal"
      tabindex="-1"
      role="dialog"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Post</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form
              id="editPostForm"
              action="/api/admin/updatePost"
              method="POST"
            >
              <input type="hidden" name="postId" id="editPostId" />
              <div class="form-group">
                <label>Title</label>
                <input
                  type="text"
                  name="title"
                  id="editPostTitle"
                  class="form-control"
                  required
                />
              </div>
              <div class="form-group">
                <label>Short Description</label>
                <input
                  type="text"
                  name="short_description"
                  id="editPostDesc"
                  class="form-control"
                  required
                />
              </div>
              <div class="row">
                <div class="col-md-6 form-group">
                  <label>Category</label>
                  <select
                    name="category"
                    id="editPostCategory"
                    class="form-control"
                  >
                    <option value="News">News</option>
                    <option value="Event">Event</option>
                    <option value="Job">Job</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="col-md-6 form-group">
                  <label>Visibility</label>
                  <select
                    name="visibilty"
                    id="editPostVisibility"
                    class="form-control"
                  >
                    <option value="Public">Public</option>
                    <option value="Private">Private</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label>Content</label>
                <textarea
                  name="post"
                  id="editPostContent"
                  class="form-control"
                  rows="10"
                  required
                ></textarea>
              </div>
              <button type="submit" class="btn btn-primary">Update Post</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div
      class="modal fade"
      id="deleteConfirmModal"
      tabindex="-1"
      role="dialog"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirm Delete</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              Are you sure you want to delete this item? This action cannot be
              undone.
            </p>
            <input type="hidden" id="deleteItemId" />
            <input type="hidden" id="deleteItemType" />
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Add Bootstrap 5 Modal handling - create modal objects
      document.addEventListener("DOMContentLoaded", function () {
        // Create modal objects
        window.editUserModal = new bootstrap.Modal(document.getElementById('editUserModal'));
        window.editPostModal = new bootstrap.Modal(document.getElementById('editPostModal'));
        window.deleteConfirmModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));

        // Set up form submissions with fetch API
        document.getElementById('addUserForm').addEventListener('submit', function(e) {
          e.preventDefault();
          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch(form.action, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(result => {
            if (result.success) {
              // Hide modal and reload users
              const modal = bootstrap.Modal.getInstance(document.getElementById('addUserModal'));
              modal.hide();
              loadUsers();
            } else {
              alert('Error: ' + (result.message || 'Failed to add user'));
            }
          })
          .catch(error => {
            console.error('Error adding user:', error);
            alert('Error adding user. See console for details.');
          });
        });

        document.getElementById('addPostForm').addEventListener('submit', function(e) {
          e.preventDefault();
          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch(form.action, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(result => {
            if (result.success) {
              // Hide modal and reload posts
              const modal = bootstrap.Modal.getInstance(document.getElementById('addPostModal'));
              modal.hide();
              loadPosts();
            } else {
              alert('Error: ' + (result.message || 'Failed to add post'));
            }
          })
          .catch(error => {
            console.error('Error adding post:', error);
            alert('Error adding post. See console for details.');
          });
        });

        document.getElementById('editUserForm').addEventListener('submit', function(e) {
          e.preventDefault();
          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch(form.action, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(result => {
            if (result.success) {
              // Hide modal and reload users
              window.editUserModal.hide();
              loadUsers();
            } else {
              alert('Error: ' + (result.message || 'Failed to update user'));
            }
          })
          .catch(error => {
            console.error('Error updating user:', error);
            alert('Error updating user. See console for details.');
          });
        });

        document.getElementById('editPostForm').addEventListener('submit', function(e) {
          e.preventDefault();
          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch(form.action, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(result => {
            if (result.success) {
              // Hide modal and reload posts
              window.editPostModal.hide();
              loadPosts();
            } else {
              alert('Error: ' + (result.message || 'Failed to update post'));
            }
          })
          .catch(error => {
            console.error('Error updating post:', error);
            alert('Error updating post. See console for details.');
          });
        });

        // Toggle admin options in add user form
        const userTypeSelect = document.querySelector('select[name="userType"]');
        const adminOptions = document.querySelector(".admin-only");
        const currentUserIsSuper = <%= user.adminLevel === "super" ? "true" : "false" %>;

        // Hide admin option for non-super admins
        if (!currentUserIsSuper) {
          const adminOption = userTypeSelect.querySelector('option[value="admin"]');
          if (adminOption) {
            adminOption.disabled = true;
            adminOption.innerHTML = "Admin (requires Super Admin)";
          }
        }

        userTypeSelect.addEventListener("change", function () {
          if (this.value === "admin") {
            adminOptions.style.display = "block";
          } else {
            adminOptions.style.display = "none";
          }
        });

        // Load users and posts on page load
        loadUsers();
        loadPosts();
      });

      // Function to load users
      function loadUsers() {
        fetch("/api/admin/users")
          .then((response) => response.json())
          .then((data) => {
            const tableBody = document.getElementById("userTableBody");
            tableBody.innerHTML = "";

            data.forEach((user) => {
              const isAdmin = user.__t === "Admin";
              const currentUserIsSuper = <%= user.adminLevel === "super" ? "true" : "false" %>;
              const canDeleteUser = !isAdmin || currentUserIsSuper;

              const row = document.createElement("tr");
              row.innerHTML = `
                <td>${user.name}</td>
                <td>${user.email}</td>
                <td>${user.batch}</td>
                <td>${isAdmin ?
                  `Admin (${user.adminLevel || 'content'})` :
                  'Alumni'}</td>
                <td>
                    <button class="btn btn-sm btn-info edit-user-btn" data-id="${user._id}">
                        <i class="fas fa-edit"></i>
                    </button>
                    ${canDeleteUser ?
                      `<button class="btn btn-sm btn-danger delete-user-btn" data-id="${user._id}">
                        <i class="fas fa-trash"></i>
                      </button>` :
                      ''}
                </td>
              `;
              tableBody.appendChild(row);
            });

            // Add event listeners to edit and delete buttons
            addUserEventListeners();
          })
          .catch((error) => console.error("Error loading users:", error));
      }

      // Function to load posts
      function loadPosts() {
        fetch("/api/admin/posts")
          .then((response) => response.json())
          .then((data) => {
            const postsGrid = document.getElementById("postsGrid");
            postsGrid.innerHTML = "";

            data.forEach((post) => {
              const card = document.createElement("div");
              card.className = "col-md-4 mb-4";
              card.innerHTML = `
                <div class="card h-100">
                    <div class="card-header bg-light">
                        <span class="badge bg-primary">${post.category}</span>
                        <span class="badge bg-${post.visibilty === "Public" ? "success" : "warning"}">${post.visibilty}</span>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">${post.title}</h5>
                        <p class="card-text">${post.short_description}</p>
                    </div>
                    <div class="card-footer d-flex justify-content-between">
                        <small class="text-muted">Posted by: ${post.createdBy}</small>
                        <div>
                            <button class="btn btn-sm btn-info edit-post-btn" data-id="${post._id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger delete-post-btn" data-id="${post._id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
              `;
              postsGrid.appendChild(card);
            });

            // Add event listeners to edit and delete buttons
            addPostEventListeners();
          })
          .catch((error) => console.error("Error loading posts:", error));
      }

      // Function to add event listeners to user buttons
      function addUserEventListeners() {
        // Edit user buttons
        document.querySelectorAll(".edit-user-btn").forEach((button) => {
          button.addEventListener("click", function () {
            const userId = this.getAttribute("data-id");
            fetch(`/api/admin/user/${userId}`)
              .then((response) => response.json())
              .then((user) => {
                document.getElementById("editUserId").value = user._id;
                document.getElementById("editUserName").value = user.name;
                document.getElementById("editUserEmail").value = user.email;
                document.getElementById("editUserBatch").value = user.batch;
                document.getElementById("editUserBranch").value = user.branch;
                document.getElementById("editUserDegree").value = user.degree;

                // Show modal using Bootstrap 5
                window.editUserModal.show();
              })
              .catch((error) => console.error("Error fetching user:", error));
          });
        });

        // Delete user buttons
        document.querySelectorAll(".delete-user-btn").forEach((button) => {
          button.addEventListener("click", function () {
            const userId = this.getAttribute("data-id");
            document.getElementById("deleteItemId").value = userId;
            document.getElementById("deleteItemType").value = "user";

            // Show modal using Bootstrap 5
            window.deleteConfirmModal.show();
          });
        });
      }

      // Function to add event listeners to post buttons
      function addPostEventListeners() {
        // Edit post buttons
        document.querySelectorAll(".edit-post-btn").forEach((button) => {
          button.addEventListener("click", function () {
            const postId = this.getAttribute("data-id");
            fetch(`/api/admin/post/${postId}`)
              .then((response) => response.json())
              .then((post) => {
                document.getElementById("editPostId").value = post._id;
                document.getElementById("editPostTitle").value = post.title;
                document.getElementById("editPostDesc").value = post.short_description;
                document.getElementById("editPostCategory").value = post.category;
                document.getElementById("editPostVisibility").value = post.visibilty;
                document.getElementById("editPostContent").value = post.post;

                // Show modal using Bootstrap 5
                window.editPostModal.show();
              })
              .catch((error) => console.error("Error fetching post:", error));
          });
        });

        // Delete post buttons
        document.querySelectorAll(".delete-post-btn").forEach((button) => {
          button.addEventListener("click", function () {
            const postId = this.getAttribute("data-id");
            document.getElementById("deleteItemId").value = postId;
            document.getElementById("deleteItemType").value = "post";

            // Show modal using Bootstrap 5
            window.deleteConfirmModal.show();
          });
        });
      }

      // Handle confirm delete button
      document
        .getElementById("confirmDeleteBtn")
        .addEventListener("click", function () {
          const itemId = document.getElementById("deleteItemId").value;
          const itemType = document.getElementById("deleteItemType").value;

          fetch(
            `/api/admin/delete${
              itemType === "user" ? "User" : "Post"
            }/${itemId}`,
            {
              method: "DELETE",
            }
          )
            .then((response) => {
              if (response.ok) {
                // Hide modal using Bootstrap 5
                window.deleteConfirmModal.hide();

                if (itemType === "user") {
                  loadUsers();
                } else {
                  loadPosts();
                }
              }
            })
            .catch((error) =>
              console.error(`Error deleting ${itemType}:`, error)
            );
        });

      // Search filters
      document
        .getElementById("userSearchInput")
        .addEventListener("input", function () {
          const searchValue = this.value.toLowerCase();
          const rows = document.querySelectorAll("#userTableBody tr");

          rows.forEach((row) => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchValue) ? "" : "none";
          });
        });

      document
        .getElementById("postSearchInput")
        .addEventListener("input", function () {
          const searchValue = this.value.toLowerCase();
          const cards = document.querySelectorAll("#postsGrid .card");

          cards.forEach((card) => {
            const text = card.textContent.toLowerCase();
            card.parentElement.style.display = text.includes(searchValue)
              ? ""
              : "none";
          });
        });

      // Filter options
      document
        .getElementById("userFilterSelect")
        .addEventListener("change", function () {
          const filterValue = this.value;
          const rows = document.querySelectorAll("#userTableBody tr");

          rows.forEach((row) => {
            const userType = row.cells[3].textContent.trim();
            row.style.display =
              filterValue === "" || userType.includes(filterValue) ? "" : "none";
          });
        });

      document
        .getElementById("postFilterSelect")
        .addEventListener("change", function () {
          const filterValue = this.value;
          const cards = document.querySelectorAll("#postsGrid .card");

          cards.forEach((card) => {
            const category = card
              .querySelector(".bg-primary")
              .textContent.trim();
            card.parentElement.style.display =
              filterValue === "" || category === filterValue ? "" : "none";
          });
        });
    </script>
  </body>
</html>
